<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>حاسبة الضمان الاجتماعي المقترح</title>

<style>
body{
  font-family: 'Arial', sans-serif;
  background: linear-gradient(to bottom, #f0f4f8, #d9e2ec);
  margin:0;
  padding:0;
}

.container{
  background:white;
  padding:20px;
  max-width: 480px;
  margin:30px auto;
  border-radius:15px;
  box-shadow:0 5px 20px rgba(0,0,0,0.1);
}

h2{
  text-align:center;
  color:#2c7be5;
}

label{
  font-weight:bold;
  margin-top:10px;
  display:block;
  color:#1a1a1a;
}

input, select, button{
  width:100%;
  padding:12px;
  margin:6px 0 12px 0;
  font-size:16px;
  border-radius:8px;
  border:1px solid #ccc;
  box-sizing:border-box;
}

button{
  background:#2c7be5;
  color:white;
  border:none;
  cursor:pointer;
  transition:0.3s;
}

button:hover{
  background:#1a5bb8;
}

.result{
  margin-top:20px;
  background:#eef3f7;
  padding:15px;
  border-radius:10px;
  line-height:1.8;
  color:#333;
}

@media (max-width: 500px){
  .container{
    margin:15px;
    padding:15px;
  }
  input, select, button{
    font-size:15px;
    padding:10px;
  }
}
</style>
</head>

<body>

<div class="container">

<h2>حاسبة الضمان الاجتماعي المقترح</h2>

<label>العمر الحالي</label>
<input type="number" id="age" placeholder="أدخل العمر">

<label>الجنس</label>
<select id="gender">
<option value="male">ذكر</option>
<option value="female">أنثى</option>
</select>

<label>نوع الضمان</label>
<select id="insuranceType">
<option value="mandatory">إلزامي</option>
<option value="optional">اختياري</option>
</select>

<label>تاريخ الانتساب</label>
<input type="date" id="joinDate">

<label>الراتب المقرر (دينار)</label>
<input type="number" id="salary" placeholder="أدخل الراتب">

<button onclick="calculate()">احسب</button>

<div class="result" id="result"></div>

</div>

<script>

// ==========================
// نسب الاقتطاع
// ==========================
const EMPLOYEE_RATE = 0.075;   
const EMPLOYER_RATE = 0.1425;  
const OPTIONAL_RATE = 0.2175;  

function calculate(){

let age = parseFloat(document.getElementById("age").value);
let gender = document.getElementById("gender").value;
let insuranceType = document.getElementById("insuranceType").value;
let joinDateValue = document.getElementById("joinDate").value;
let salary = parseFloat(document.getElementById("salary").value);

if(!age || !joinDateValue || !salary){
document.getElementById("result").innerHTML="الرجاء إدخال جميع البيانات";
return;
}

let joinDate = new Date(joinDateValue);
let today = new Date();

// ==========================
// حساب سنوات الاشتراك
// ==========================
let diff = today - joinDate;
let yearsSubscribed = diff / (1000*60*60*24*365);
let monthsSubscribed = yearsSubscribed * 12;

// ==========================
// حساب مجموع الأقساط
// ==========================
let employeePaid = 0;
let employerPaid = 0;
let totalPaid = 0;

if(insuranceType === "optional"){
employeePaid = salary * OPTIONAL_RATE * monthsSubscribed;
totalPaid = employeePaid;
}else{
employeePaid = salary * EMPLOYEE_RATE * monthsSubscribed;
employerPaid = salary * EMPLOYER_RATE * monthsSubscribed;
totalPaid = employeePaid + employerPaid;
}

// ==========================
// زيادة الشروط بعد 2030
// ==========================
let currentYear = today.getFullYear();
let extraYears = 0;
if(currentYear >= 2030){
extraYears = (currentYear - 2030 + 1) * 0.5;
}

// ==========================
// التقاعد المبكر
// ==========================
let earlyAgeRequired = 50;
let earlySubsRequired = gender === "male" ? 21 : 19;

// ==========================
// الشيخوخة
// ==========================
let oldAgeRequired = gender === "male" ? 60 : 55;
let oldSubsRequired = 15;

oldAgeRequired += extraYears;
oldSubsRequired += extraYears;

// ==========================
// المتبقي
// ==========================
let remainingEarlySubs = Math.max(0, earlySubsRequired - yearsSubscribed);
let remainingOldSubs = Math.max(0, oldSubsRequired - yearsSubscribed);

let remainingEarlyAge = Math.max(0, earlyAgeRequired - age);
let remainingOldAge = Math.max(0, oldAgeRequired - age);

// ==========================
// الاستحقاق
// ==========================
let earlyEligible = (age >= earlyAgeRequired && yearsSubscribed >= earlySubsRequired);
let oldEligible = (age >= oldAgeRequired && yearsSubscribed >= oldSubsRequired);

// ==========================
// خصم المبكر لو تقاعد الآن
// ==========================
let earlyPenaltyPercent = 0;
let reducedSalary = salary;

if(earlyEligible && age < oldAgeRequired){
let yearsBeforeOld = oldAgeRequired - age;
earlyPenaltyPercent = yearsBeforeOld * 4;
if(earlyPenaltyPercent > 100) earlyPenaltyPercent = 100;
reducedSalary = salary * (1 - earlyPenaltyPercent/100);
}

// ==========================
// راتب المبكر عند أول استحقاق
// ==========================
let ageAtEarlyEligibility = Math.max(earlyAgeRequired, age + remainingEarlySubs);
let yearsBeforeOldAtEarly = Math.max(0, oldAgeRequired - ageAtEarlyEligibility);
let earlyPenaltyAtEligibility = yearsBeforeOldAtEarly * 4;
if(earlyPenaltyAtEligibility > 100) earlyPenaltyAtEligibility = 100;
let expectedEarlySalary = salary * (1 - earlyPenaltyAtEligibility/100);

// ==========================
// عرض النتائج
// ==========================
document.getElementById("result").innerHTML = `

<b>سنوات الاشتراك حتى اليوم:</b> ${yearsSubscribed.toFixed(2)} سنة
<hr>

<b>مجموع الأقساط المدفوعة حتى اليوم</b><br>
ما دفعه المنتسب: ${employeePaid.toFixed(2)} دينار<br>
${insuranceType === "mandatory" ? "ما دفعته المؤسسة: " + employerPaid.toFixed(2) + " دينار<br>" : ""}
<b>إجمالي المبالغ:</b> ${totalPaid.toFixed(2)} دينار
<hr>

<b>التقاعد المبكر</b><br>
العمر المطلوب: ${earlyAgeRequired} سنة<br>
سنوات الاشتراك المطلوبة: ${earlySubsRequired} سنة<br>
سنوات الاشتراك الحالية: ${yearsSubscribed.toFixed(2)} سنة<br>
الاشتراكات المتبقية: ${remainingEarlySubs.toFixed(2)} سنة<br>
المتبقي للعمر: ${remainingEarlyAge.toFixed(2)} سنة<br>
الاستحقاق: ${earlyEligible ? "✔ مستحق" : "✖ غير مستحق"}
<hr>

<b>راتب التقاعد المبكر عند أول استحقاق</b><br>
العمر المتوقع عند الاستحقاق: ${ageAtEarlyEligibility.toFixed(2)} سنة<br>
نسبة الخصم المتوقعة: ${earlyPenaltyAtEligibility.toFixed(2)} %<br>
الراتب المتوقع: ${expectedEarlySalary.toFixed(2)}
<hr>

<b>تقاعد الشيخوخة</b><br>
العمر المطلوب: ${oldAgeRequired.toFixed(2)} سنة<br>
سنوات الاشتراك المطلوبة: ${oldSubsRequired.toFixed(2)} سنة<br>
سنوات الاشتراك الحالية: ${yearsSubscribed.toFixed(2)} سنة<br>
الاشتراكات المتبقية: ${remainingOldSubs.toFixed(2)} سنة<br>
المتبقي للعمر: ${remainingOldAge.toFixed(2)} سنة<br>
الاستحقاق: ${oldEligible ? "✔ مستحق" : "✖ غير مستحق"}
<hr>

<b>لو تقاعد الآن بالمبكر</b><br>
نسبة الخصم: ${earlyPenaltyPercent.toFixed(2)} %<br>
الراتب بعد الخصم: ${reducedSalary.toFixed(2)}
`;

}

</script>

</body>
</html>